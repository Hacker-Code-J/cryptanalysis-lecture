\documentclass[11pt,openany]{article}

\input{cryptanalysis-note-setup}
%\input{../category-theory-setup-tcolorbox}
% Header and footer formatting
\pagestyle{fancy}
\fancyhead{}
\fancyhf{}
\rhead{\textcolor{TealBlue2}{\textbf{Cryptanalysis-Note}}}%\rule{3cm}{0.4pt}}
\lhead{\textcolor{TealBlue2}{\textbf{Lecture-Note 1}}}
% Define footer
\newcommand{\footer}[1]{
\begin{flushright}
	\vspace{2em}
	\includegraphics[width=2.5cm]{school_logo.jpg} \\
	\vspace{1em}
	\textcolor{TealBlue2}{\small\textbf{#1}}
\end{flushright}
}
%\rfoot{\large Department of Information Security, Cryptogrphy and Mathematics, Kookmin Uni.\includegraphics[height=1.5cm]{school_logo.jpg}}
\fancyfoot{}
\fancyfoot[C]{-\thepage-}

\input{cryptanalysis-note-thm}
\input{cryptanalysis-note-command}

\setstretch{1.25}
\begin{document}
\pagenumbering{arabic}
\begin{center}
	\huge\textbf{Differential Cryptanalysis}\\
	\vspace{0.5em}
	\normalsize{\today}\\
	\vspace{0.5em}
	\large\textbf{Ji, Yong-hyeon}\\
	\vspace{0.5em}
\end{center}

\section{DDT}

\begin{itemize}
	\item Motivation
	\item Sequences of Bits
	\item The XOR operation
	\item Properties of XOR
	\item Difference of Sets
	\item Difference of Sets of a S-Box
	\item The DDT of a S-Box
	\item Properties of the DDT
	\item The DDT and Probabilities
	\item The DDT of a Linear S-Box
	\item The DDT of a XOR S-Box
	\item Code for the DDT
	\item The DDT's of the S-Boxes of DES
	\item The DDT's of the Rijndael S-Box
\end{itemize}
\newpage
\paragraph{Motivation}

\begin{itemize}
	\item Let $S:\F_2^n\to\F_2^m$ be a S-Box.
	\item We define the \textbf{differential distribution table} $\mathcal{D}_S\in M_{2^n\times 2^m}(\Z_{\geq 0})$, abbreviated as $\ddt$.
\end{itemize}

\paragraph{Sequences of Bits}
\begin{itemize}
	\item $\F_2\set{0,1}$
	\item $\F_2^n=\set{(x_1,\dots,x_n):x_i\in\F_2}$ and $\abs{\F_2^n}=2^n$
	\item $\F_2^n\simeq\Z_{2^n}=\set{0,1,\dots,2^n-1}$
\end{itemize}

\paragraph{The XOR operation}
\begin{itemize}
	\item $\oplus:\F_2\times\F_2\to\F_2$.
	\item The operation XOR is like addition modulo 2.
	\item It is denoted by $\oplus$.
\end{itemize}
\begin{center}
	\begin{tabular}{c|c||c}
		\toprule[1.2pt]
		$x$ & $y$ & $x\oplus y$\\
		\hline
		0 & 0 & 0\\
		\hline
		0 & 1 & 1\\
		\hline
		1 & 0 & 1\\
		\hline
		1 & 1 & 0\\
		\bottomrule[1.2pt]
	\end{tabular}
\end{center}

\begin{itemize}
	\item 
	\begin{align*}
		\lnot (p\iff q) \\
		\lnot ((p\implies q) \land (q\implies p))\\
		\lnot ((\lnot p \lor q) \land (\lnot q\lor p))\\
		(p\land \lnot q)\lor(q\land\lnot p) \\
		[(p\land\lnot q)\lor q]\land[(p\land\lnot q)\lor\lnot p] \\ 
		[(p\lor q)\land(\lnot q\lor q)]\land[(p\lor\lnot p)\land(\lnot q\lor\lnot p)] \\
		(p\lor q)\land ()
	\end{align*}
	\item \begin{align*}
		(p\lor q)\land(\lnot(p\land q))\\
		(p\lor q)\land(\lnot p\lor\lnot q))\\
		((p\lor q)\land\lnot p)\lor	((p\lor q)\land\lnot q)	\\
		[(p\land\lnot p)\lor(q\land\lnot p)]\lor [(p\land\lnot q)\lor(q\land\lnot q)] \\
		[F\lor(q\land\lnot p)]\lor [(p\land\lnot q)\lor F] \\
		(q\land\lnot p)\lor (p\land\lnot q)
	\end{align*}
\end{itemize}

\paragraph{Difference of Sets}
\begin{definition}[Difference Set]
	Given $\alpha\in\F_2^n$, we define the subset $\Delta_\alpha$ of $\F_2^n\times\F_2^n$ by \[
	\Delta_\alpha=\set{(x_1,x_2)\in\F_2^n\times\F_2^n:x_1\oplus x_2=\alpha}\subseteq\F_2^n\times\F_2^n.
	\] We call $\Delta_\alpha$ the \textbf{difference set} of $\alpha$.
\end{definition}

\begin{proposition}
	For any $\alpha\in\F_2^n$ the set $\Delta_\alpha$ contains $2^n$ elements and can be expressed as \[
	\Delta_\alpha=\set{(x,x\oplus\alpha):x\in\F_2^n}.
	\]
\end{proposition}
\begin{proof}
	Let \begin{align*}
		S&:=\set{(x_1,x_2)\in\F_2^n\times\F_2^n:x_1\oplus x_2=\alpha}, \\
		T&:=\set{(x,x\oplus\alpha):x\in\F_2^n}.
	\end{align*} We must show that $S=T$:
	\begin{itemize}
		\item[($S\subseteq T$)] Let $(x,y)\in S$ then by definition $x\oplus y=\alpha$.
		Since $(x\oplus y=\alpha)\Rightarrow (y=x\oplus \alpha)$, \[
		(x,y)=(x,x\oplus \alpha)\in T.
		\]
		\item[($T\subseteq S$)] Let $(x,x\oplus\alpha)\in T$. Since \[
		x\oplus(x\oplus\alpha)=\alpha,
		\] $(x,x\oplus\alpha)\in S$.
	\end{itemize}
\end{proof}

\begin{itemize}
	\item So $\Delta_\alpha\subseteq\F_2^n\times\F_2^n$ is bijective with $\F_2^n$
	\item A bijective map is given by \[
	\fullfunction{\varphi}{\F_2^n}{\Delta_\alpha}{x}{(x,x\oplus\alpha)}
	\] 
\end{itemize}

\begin{itemize}
	\item Let us consider the case $\alpha=0$ for the set $\Delta_\alpha$.
	\item When $\alpha=0$ the difference set is \[
	\Delta_0=\set{(x,x):x\in\F_2^n}
	\]
	\item This set is often called the \textbf{diagonal} of $\F_2^n\times\F_2^n$.
\end{itemize}

\paragraph{Difference Sets of A S-BOX}

\begin{definition}
	Let $S:\F_2^n\to\F_2^n$ be a S-Box, and let $\alpha\in\F_2^n$ and $\beta\in\F_2^m$. We define the \textbf{difference set} of $S$ w.r.t. $\alpha$ and $\beta$ by \[
	\Delta_{\alpha,\beta}=\set{(x_1,x_2)\in\F_2^n\times\F_2^n:x_1\oplus x_2=\alpha\ \text{and}\ S(x_1)\oplus S(x_2)=\beta}\subseteq\F_2^n\times\F_2^n.
	\] That is, $\Delta_{\alpha,\beta}$ is the set of ordered pairs of elements from $\F_2^n$ which have a difference of $\alpha$ and such that their images under $S$ have a difference of $\beta$.
\end{definition}
\begin{remark}
	This can also written as \[
	\Delta_{\alpha,\beta}=\set{(x_1,x_2)\in\Delta_\alpha:(S(x_1),S(x_2))\in\Delta_\beta}\subseteq\Delta_a
	\]
\end{remark}
\begin{note}
	$\Delta_{\alpha,\beta}$ is always defined w.r.t. a given S-Box $S$. If we want to make this dependence explicit we can write $\Delta_{\alpha,\beta}^S$.
\end{note}

\begin{note}
	We define $d_{\alpha,\beta}$ to be the cardinality of the finite set $\Delta_{\alpha,\beta}$, namely \[
	d_{\alpha,\beta}:=\abs{\Delta_{\alpha,\beta}}\in\Z_{\geq 0}
	\]
\end{note}
\begin{itemize}
	\item When $\alpha=0$ and $\beta=0$ we have \[
	\Delta_{0,0}=\Delta_0=\set{(x,x):x\in\F_2^n}.
	\]
	\item In general when $\alpha=0$ we find that \[
	\Delta_{0,\beta}=\begin{cases}
		\Delta_0 &:\beta=0\\
		\emptyset &:\beta\neq 0
	\end{cases}
	\] Since $\abs{\Delta_0}=2^n$ and $\abs{\emptyset}=0$, \[
	d_{0,\beta}=\begin{cases}
		2^n &:\beta=0 \\
		0 &:\beta\neq 0
	\end{cases}
	\]
\end{itemize}

\begin{proposition}
	The integer $d_{\alpha.\beta}\in\Z_{\geq 0}$ is always even.
\end{proposition}
\begin{proof}
	Recall that $0$ is even.
	\begin{itemize}
		\item[] (Case I) When $\alpha=0$, we saw either $d_{0,\beta}\in\set{0,2^n}$ and these are even in either case.
		\item[] (Case II) Suppose that $\alpha\neq 0$ and $\Delta_{\alpha,\beta}\neq\emptyset$.
	\end{itemize}
\end{proof}

\newpage
\begin{remark}
	To describe a acategory it is necessary to specify:
	\begin{itemize}
		\item (Objects) $\obj{\category}=\set{A,B,C,D,E\dots}$\\
		\vspace{8pt}
		\begin{figure}[h!]\centering
			\begin{tikzcd}[remember picture, cells={nodes={draw=none}}]
				| [alias=A] | A &  & B &  & D \\
				&  &   &  &   \\
				&  & C &  & | [alias=E] | E
			\end{tikzcd}
			
			\begin{tikzpicture}[overlay, remember picture]
				% Calculate bounding box coordinates
				\coordinate (TopLeft) at ($(A.north west) + (-0.5,0.5)$);
				\coordinate (BottomRight) at ($(E.south east) + (0.5,-0.5)$);
				% Draw rounded rectangle
				\draw[rounded corners, thick, red] (TopLeft) rectangle (BottomRight);
				% Label the rectangle
				\node at ($(TopLeft)!0.5!(BottomRight) + (0,1.75)$) [above] {$\category$};
			\end{tikzpicture}
		\end{figure}
		
		\item (Morphisms) $\homo{A,B}=\set{f,f',\dots}$; $\homo{A,B}\neq\homo{B,A}$\\
		\vspace{8pt}
		\begin{figure}[h!]\centering
			\begin{tikzcd}[remember picture, cells={nodes={draw=none}}]
				| [alias=A] | A \arrow[rr, "f"] \arrow[rrdd, "h"] \arrow[rr, "f'", bend left=49] \arrow["\mathsf{id}_A"', loop, distance=2em, in=215, out=145] \arrow[rrdd, dashed, bend right=49] \arrow[rrdd, dashed, bend right=49, shift right=3] &  & B \arrow[dd, "g"] \arrow[dd, "g'", bend left=49] \arrow["\mathsf{id}_B"', loop, distance=2em, in=35, out=325] &  & D \arrow[dd, dashed] \arrow[dd, dashed, bend left] \arrow[dd, dashed, bend right] \arrow["\mathsf{id}_D"', loop, distance=2em, in=125, out=55] \\
				&  &                                                                                                               &  &                                                                                                                                                \\
				&  & C \arrow["\mathsf{id}_C"', loop, distance=2em, in=305, out=235]                                               &  & | [alias=E] | E \arrow["\mathsf{id}_E"', loop, distance=2em, in=305, out=235]                                                                               
			\end{tikzcd}
			
			\begin{tikzpicture}[overlay, remember picture]
				% Calculate bounding box coordinates
				\coordinate (TopLeft) at ($(A.north west) + (-1.5,1.5)$);
				\coordinate (BottomRight) at ($(E.south east) + (1.5,-1.5)$);
				% Draw rounded rectangle
				\draw[rounded corners, thick, red] (TopLeft) rectangle (BottomRight);
				% Label the rectangle
				\node at ($(TopLeft)!0.5!(BottomRight) + (0,2.75)$) [above] {$\category$};
			\end{tikzpicture}
		\end{figure}
		\item (Composition) \\ \adjustbox{scale=1, center}{
			\begin{tikzcd}
				&  & B \arrow[rrd, "g"] &  &   \\
				A \arrow[rrrr, "g\circ f"] \arrow[rru, "f"] &  &                    &  & C
		\end{tikzcd}}
		\item (Identity) \begin{center}
			\begin{tikzcd}
				A \arrow[rrrr, "\mathsf{id}_B\circ f=f=f\circ \mathsf{id}_A"] \arrow["\mathsf{id}_A"', loop, distance=2em, in=125, out=55] &  &  &  & B \arrow["\mathsf{id}_B"', loop, distance=2em, in=125, out=55]
			\end{tikzcd}
		\end{center}
		\item (Associativity) \begin{center}
			\begin{tikzcd}
				A \arrow[rr, "f"] \arrow[rrrr, "g\circ f", bend left] \arrow[rrrrrr, "h\circ(g\circ h)" description, bend left, shift left=3] \arrow[rrrrrr, "(h\circ g)\circ f" description, bend right, shift right=3] &  & B \arrow[rr, "g"] \arrow[rrrr, "h\circ g", bend right] &  & C \arrow[rr, "h"] &  & D
			\end{tikzcd}
		\end{center}
	\end{itemize}
\end{remark}

\vfill
\section{Examples}

\begin{example}[Trivial Category]
\ \begin{itemize}
	\item $\obj{\category}=\set{A}$
	\item $\homo{A,A}=\set{\id_A}$
\end{itemize}
\adjustbox{scale=1.25,center}{
\begin{tikzcd}
	A \arrow["\mathsf{id}_A"', loop, distance=2em, in=35, out=325]
\end{tikzcd}}
\end{example}

\begin{example}
	\ \begin{itemize}
		\item $\obj{\category}=\set{A,B}$
		\item $\homo{A,B}=\set{f}$
		\item $\homo{B,A}=\emptyset$
	\end{itemize}
	\adjustbox{scale=1.25,center}{
		\begin{tikzcd}
			A \arrow[r, "f"] & B
	\end{tikzcd}}
\end{example}

\begin{example}
	Let $(G,*)$ be a group. \begin{itemize}
		\item $\obj{\category}=\set{X}$
		\item $\homo{X,X}=\set{G}$
		\item Define $g\circ f:=g*f$
	\end{itemize}
\end{example}

\begin{example}
\ \begin{itemize}
	\item \textbf{Set};\quad $$\text{Set}\xrightarrow[\text{Function}]{}\text{Set}$$
	\item \textbf{Grp};\quad $$\text{Group}\xrightarrow[\text{Homomorphism}]{}\text{Group}$$
	\item \textbf{Top};\quad $$\text{Topological Space}\xrightarrow[\text{Continuous Map}]{}\text{Topological Space}$$
	\item \textbf{Vect}$_K$;\quad $$\text{Vector Space}\xrightarrow[\text{Linear Transformation}]{}\text{Vector Space}$$
\end{itemize}
\end{example}

\newpage
\begin{example}
	\ \begin{itemize}
		\item 
		$f:x\to y$ if and only if $x\leq y$\\
		\adjustbox{scale=1.25, center}{
			\begin{tikzcd}
				x \arrow[rr, "f"]            &  & y \arrow[rr, "g"] &  & z \\
				x \arrow[rrrr, "h"] &  &                   &  & z
		\end{tikzcd}}
		\item $\id_x:x\to x$ if and only if $x\leq x$
	\end{itemize}
	\[
	\begin{array}{c}
		(\R,\leq) \\ \text{Real Number}\xrightarrow[\text{Ordering}]{}\text{Real Number}
	\end{array}
	\]
\end{example}

\vfill
\section{Product and Dual Categories}

\subsection{Product Categories}
\[
\mathcal{C}\times\mathcal{D}
\]
\begin{align*}
\obj{(\mathcal{C}\times\mathcal{D})}&=\obj{\mathcal{C}}\times\obj{\mathcal{D}}\\
\mathsf{hom}_{\mathcal{C}\times\mathcal{D}}((A,B),(A',B'))&=\mathsf{hom}_\category(A,A')\times\mathsf{hom}_{\mathcal{D}}(B,B')
\end{align*}
\[\begin{array}{cc}
	\mathcal{C} &\mathcal{D} \\ A\xrightarrow{f}A' & B\xrightarrow{g}B'
\end{array}\]
\[\begin{array}{c}
	\mathcal{C} \times\mathcal{D} \\ (A,B)\xrightarrow{(f,g)}(A',B')
\end{array}\]

\subsection{Dual Categories}
\[\begin{array}{cc}
	\category & \mathcal{C}^\op \\ A\to B & A\from B
\end{array}\]

\newpage
\section{Functors}
\begin{align*}
	F:\category&\to\mathcal{D}\\
	F:\obj{\category}&\to\obj{\mathcal{D}}\\
	F:\homo{\category}&\to\homo{\mathcal{D}}\\
\end{align*}

\[
\fullfunction{F}{\category}{\mathcal{D}}{A}{F(A)}
\]
\adjustbox{scale=1.25,center}{
\begin{tikzcd}
	A \arrow[rr, "f"]        & {} \arrow[d, maps to] & B    \\
	F(A) \arrow[rr, "F(f)"'] & {}                    & F(B)
\end{tikzcd}}

\newpage
\section{Natural Transformation}
\begin{itemize}
	\item Let \[
	\begin{tikzcd}
		\mathcal{C} \arrow[r, "F", shift left] \arrow[r, "G"', shift right] & \mathcal{D}
	\end{tikzcd}
	\] be categories and functors.
	\item A map 
	% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBoBGAXVJADcBDAGwFcYkQAdDgW3pwAsAxk2ABhAL4hxpdJlz5CKAEwVqdJq3ZdeA4Y2AARSdNnY8BIuVLE1DFm0QgpMkBjMLLpJbY0On4tRgoAHN4IlAAMwAnCG4kMhAcCCQrEAAjGDAoJAA2BLtNRwAxEBo4fiwInCQAWgBWGkZ6DMYABTlzRRAsMGxYZ0iYuMQEpJSaDKzavJoCvwBxUpByyurEBpAmlvb3C0cevrYTEGjYpBVE5MQAZkaevygIZjTGNhp+GHpsxDBmRkYaDh6FhGOxIGA3ptmjA2h0PPtelh+rNfFoODAgVJKOIgA
	\adjustbox{scale=1.25,center}{\begin{tikzcd}
		& {} \arrow[dd, "\eta" description, Rightarrow] &             \\
		\mathcal{C} \arrow[rr, "F" description, bend left=60, shift left=5] \arrow[rr, "G" description, bend right=60, shift right=5] &                                               & \mathcal{D} \\
		& {}                                            &            
	\end{tikzcd}}
	is a natural transformation
\end{itemize}
% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBoBGAXVJADcBDAGwFcYkQANEAX1PU1z5CKAEyli1Ok1bsAYgAoOASh58QGbHgJExIyQxZtEIAOKKVvfpqE6K+6UZA9JMKAHN4RUADMAThABbJHIaHAgkMSlDdgAdGJgcegB9LksQP0CkMhAw4JpGLDBHKAgcHFcQGgMZY1lVH38gxGzcxEjqxxNKkAKi9hKyivz6ACMYRgAFAS1hEF8sNwALHHr0xqzQ8MQAZnzC4ohmEcY2GkWYeigkMGZGRlD6LEZ2SD6qh1j4xO7GUfGp6zaYyFbCwZzcIA
\adjustbox{scale=1.25,center}{\begin{tikzcd}
	&  & F(A)\in\obj{\mathcal{D}} \arrow[dd, "\eta_A"] \\
	A\in\obj{\category} \arrow[rru, "F", dotted] \arrow[rrd, "G"', dotted] \arrow[rr, "\eta" description, Rightarrow] &  & {}                        \\
	&  & G(A)\in\obj{\mathcal{D}}                  
\end{tikzcd}}

% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAEEQBfU9TXfIRRkATFVqMWbAELdeIDNjwEiI8uPrNWiEADEAFOwCUcvksFEALOuqapOgOKGTPMwJUo1Y25O1790i7yiu5CyNbeElpsToGmCvzKYQDMNlH2IPEhSUSpkXZ+3OIwUADm8ESgAGYAThAAtkhkIDgQSACMPtE6VfG1DUhqLW2I1ul+BlVB1XWNiKnDSACsXRlOU32zg9StSAsFbAA6hzA4dAD6nNQMdABGMAwACokWOjVYpQAWOJsDozsjFbjI4nM7nWSuED9OZDXaIIEMLBgPxQOhwT4lEDXO4PZ7mDwgJHYWBY4E6fTHGAADywcBwcAAhEYAPy-ObNOFDRHIthQCA4HCY1YTUk3e5PF4EolYEmQ6EdAFIMYHHS6UVIlH8wVQUU4iX4oSEsDE1hyraIDkjBb3MA6xAANma3M1AqFZJADl14rxoTY0tl8nliE6i3h1w1vK1bptdoAtI7hTEvbjJYb-abA+bLUh7dQY0qAJzhnk6PlMW4MVjY72pv3GmVV92Us6kjF0O1gJgMBg7OhYBhsSA8s1-ENwgDseZgtqQscsRZAzsj5crrZg7aQne7vf7g4IjbFKYNdZNpJVIGbdCKXCAA
\adjustbox{scale=1.25,center}{\begin{tikzcd}
		A \arrow[dd, "f"] \arrow[rr, "F" description, dotted] \arrow[rrrr, "G" description, dotted, bend left=60] \arrow[rrr, "\eta" description, Rightarrow, bend left=49] &  & F(A) \arrow[dd, "F(f)"] \arrow[rr, "\eta_A"'] \arrow[rrdd, "(\exists!)?" description, dashed] & {} & G(A) \arrow[dd, "G(f)"] \\
		&  &                                                                                               &    &                         \\
		B \arrow[rr, "F" description, dotted] \arrow[rrrr, "G" description, dotted, bend right=60] \arrow[rrr, "\eta" description, Rightarrow, bend right=49]               &  & F(B) \arrow[rr, "\eta_B"]                                                                     & {} & G(B)                   
\end{tikzcd}}

\newpage
\footer{Department of Information Security, Cryptology and Mathematics\\
	College of Science and Technology\\
	Kookmin University}

\newpage
\input{cryptanalysis-note1-ref}
%\bibliography{category-theory-note-ref}
%\bibliographystyle{abbrv}
\end{document}